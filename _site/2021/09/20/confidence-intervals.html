<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preconnect" href="https://cdnjs.cloudflare.com"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><title> Confidence intervals from hypothesis tests - pboes</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><link rel="alternate" type="application/atom+xml" title="pboes" href="/atom.xml"><link rel="alternate" type="application/json" title="pboes" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;500;700&display=swap" rel="stylesheet"><style> *,:after,:before{box-sizing:border-box;color:inherit;margin:0;padding:0}html{font-size:15px}#theme-toggle{opacity:0.65;position:relative;border-radius:5px;height:25px;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;transition:opacity 0.3s ease 0s;border:none;outline:none;background:none;cursor:pointer;padding:0px;appearance:none;transform:scale(0.8)}html,html[data-theme="light"]{--very-light-text-color: rgb(222, 222, 222);--light-text-color: rgb(89, 183, 255);--medium-text-color: #555;--main-text-color: #333;--dark-text-color: #393e46;--link-color: rgb(50, 87, 209);--code-bg-color: rgb(245, 245, 245);background-color:#fff}html #theme-toggle div,html[data-theme="light"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent, transparent);transform:scale(1);transition:all 0.45s ease 0s;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon, #2d3748)}html #theme-toggle div::before,html[data-theme="light"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;transform:translate(0px, 0px);opacity:1;transition:transform 0.45s ease 0s}html #theme-toggle div::after,html[data-theme="light"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748);transform:scale(0);transition:all 0.35s ease 0s}html[data-theme="dark"]{--very-light-text-color: #EEE;--light-text-color: #c4bbf0;--medium-text-color: #52057b;--main-text-color: #EAEAEA;--dark-text-color: rgb(36, 38, 42);--link-color: rgb(255, 89, 125);--code-bg-color: rgb(36, 38, 42);background-color:#131418}html[data-theme="dark"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:4px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);background-color:var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(0.55);transition:all 0.45s ease 0s;overflow:visible;box-shadow:none}html[data-theme="dark"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:2px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);border-radius:50%;transform:translate(14px, -14px);opacity:0;transition:transform 0.45s ease 0s}html[data-theme="dark"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),0 23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(1);transition:all 0.35s ease 0s}body{font-family:"Fira Sans";text-rendering:optimizeLegibility;line-height:1.75;color:var(--main-text-color)}a{color:var(--link-color);text-decoration:none}.post p{margin:1rem 0}.meta{margin:1.4rem 0}code,pre{background:var(--code-bg-color);margin:0 -27px;border-width:1px}code{margin:unset;padding:0.1rem;color:var(--light-text-color)}pre code{background-color:unset;color:unset}pre{border-width:3px;padding:0.8rem;white-space:pre-wrap;border-style:none none none solid;border-color:var(--light-text-color)}img{max-width:100%}hr{background:var(--light-text-color);height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:0.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem 0}section{margin-top:5.5rem}blockquote{font-style:italic;border-left:5px solid var(--dark-text-color);padding-left:1rem}h1{color:var(--main-text-color);text-transform:uppercase;font-size:larger;font-weight:bold;margin-bottom:1.5rem}h2,h3,h4,h5{font-weight:bold;font-size:1rem;margin-bottom:1.5rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts>h3{font-weight:500}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:0.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}time{color:var(--main-text-color)}.post>h1.title{font-size:x-large;margin-top:0;margin-bottom:0}.post>time{margin-bottom:0;margin-top:3rem}main{display:flex;max-width:47rem;margin:-5rem auto 0;padding:2.4rem 2rem;flex-direction:column}.flex-row-between{display:flex;flex-direction:row;justify-content:space-between}.social-footer{padding:1rem;display:flex;justify-content:center;position:initial}.social-footer .social-footer-icons .fa{font-size:1.3rem;color:#a9a9a9}.social-footer .social-footer-icons .fa:hover{color:dimgray;transition:color 0.3s ease-in}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}main{padding:0 2rem}}section{flex-grow:999;display:flex;flex-direction:column}figcaption{font-size:smaller}.bio{margin-bottom:5rem}::selection{background-color:#fffba0;color:#333}.search-article{position:relative}.search-article label[for="search-input"]{position:relative;top:-10px;left:11px}.search-article input[type="search"]{top:-1rem;left:0;border:0;width:100%;height:30px;outline:none;position:absolute;border-radius:5px;padding:10px 10px 10px 35px;color:var(--main-text-color);-webkit-appearance:none;background-color:rgba(128,128,128,0.1);border:1px solid rgba(128,128,128,0.1)}.search-article input[type="search"]::-webkit-input-placeholder{color:#808080}.search-article input[type="search"]::-webkit-search-decoration,.search-article input[type="search"]::-webkit-search-results-decoration{display:none}#search-results{text-align:center}#search-results li{text-align:center}.post-nav{display:flex;position:relative;margin-top:0;border-top:2px solid var(--light-text-color);line-height:1.4}.post-nav .post-nav-item{border-bottom:0;padding-bottom:10px;width:50%;padding-top:10px;text-decoration:none;box-sizing:border-box}.post-nav .post-nav-item .post-title{color:var(--main-text-color)}.post-nav .post-nav-item:hover .post-title,.post-nav .post-nav-item:focus .post-title{color:var(--link-color);opacity:0.9}.post-nav .post-nav-item .nav-arrow{font-size:17px;color:var(--main-text-color);margin-bottom:3px;font-weight:bold}.post-nav .post-nav-item:nth-child(odd){padding-left:0;padding-right:20px}.post-nav .post-nav-item:nth-child(even){text-align:right;padding-right:0;padding-left:20px}.tags ul{list-style:none;display:grid;grid-template-columns:auto auto auto auto auto auto;grid-template-rows:auto auto auto auto}.tags li{white-space:normal;text-overflow:ellipsis}.timeline{position:center;width:650px;margin:-6em auto;padding:1px;list-style-type:none}@media (max-width: 860px){.timeline{width:100%}}.timeline:before{position:absolute;left:50%;top:0;content:' ';display:block;width:6px;height:100%;margin-left:-3px;background:var(--light-text-color);z-index:5}@media (max-width: 375px){.timeline:before{height:150%}}.timeline li{padding:2em 0}@media (max-width: 860px){.timeline li{padding:2em 0}}.timeline li::after{content:"";display:block;clear:both;visibility:hidden}.direction-l{position:relative;width:287px;float:left;text-align:right}@media (max-width: 860px){.direction-l{float:none;width:100%;text-align:center}}.direction-l .flag{color:#333;box-shadow:-1px 1px 1px rgba(0,0,0,0.52)}.direction-l .flag:after{content:"";position:absolute;left:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-left-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-l .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-l .time-wrapper{float:left}@media (max-width: 860px){.direction-l .time-wrapper{float:none}}.direction-r{position:relative;width:293px;float:right;text-align:left}@media (max-width: 860px){.direction-r{float:none;width:100%;text-align:center}}.direction-r .flag{color:#333;box-shadow:1px 1px 1px rgba(0,0,0,0.52)}.direction-r .flag:after{content:"";position:absolute;right:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid transparent;border-right-color:#f8f8f8;border-width:8px;pointer-events:none}@media (max-width: 860px){.direction-r .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid transparent;border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-r .flag:before{left:-40px}.direction-r .time-wrapper{float:right}@media (max-width: 860px){.direction-r .time-wrapper{float:none}}.flag-wrapper{position:relative;display:inline-block;text-align:center}@media (max-width: 860px){.flag-wrapper{text-align:center}}.flag-wrapper .flag{position:relative;display:inline;background:#f8f8f8;padding:6px 10px;border-radius:5px;font-weight:600;text-align:left}@media (max-width: 860px){.flag-wrapper .flag{background:#fff;z-index:15}}.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:60%;right:-40px;content:' ';display:block;width:12px;height:12px;margin-top:-10px;background:#fff;border-radius:10px;border:4px solid var(--link-color);z-index:10}@media (max-width: 860px){.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:-30px;left:53%;content:' ';display:block;margin-left:-10px}}.time-wrapper{display:inline;line-height:1em;font-size:0.66666em;color:var(--link-color);vertical-align:middle}@media (max-width: 860px){.time-wrapper{display:block;position:relative;margin:4px 0 0 0;z-index:14}}.time-wrapper .time{display:inline-block;padding:4px 6px;background:#f8f8f8}.desc{margin:1em 0.2em -3.5em 0;font-size:0.9em;line-height:1.5em}.desc a{color:var(--link-color);text-decoration:none}.desc a:hover{text-decoration:underline}@media (max-width: 860px){.desc{position:relative;margin:1em 1em 0 1em;padding:1em;background:var(--code-bg-color);box-shadow:0 0 1px rgba(0,0,0,0.2);z-index:15}}</style></head><body><main><section class="post"><div class="flex-row-between"> <a href="http://localhost:4000">« back</a> <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()"><div></div></button></div><time datetime="2021-09-20T00:00:00+00:00">Sep 20, 2021 </time><h1 class="title"> Confidence intervals from hypothesis tests</h1><span class="meta"> </span><p>Confidence intervals are a standard measure of confidence in data analysis: Almost any piece of software you use to run an OLS regression will provide you with a confidence interval - usually some range \([a,b]\subseteq \mathbb{R}\) for every estimated coefficient - as part of the summary of the regression. The question what this interval signifies is commonly answered by saying that, provided the assumptions of OLS regression hold, with high probability the true value of the quantity you estimate lies within the given interval.</p><p>This answer confused me when I first heard it. Clearly an interval either contains a value or it doesn’t. So where does the probability come from? It turns out that the idea is simple (and quite independent of OLS regression) and that we can understand regression confidence intervals based on a simple but elegant connection between confidence intervals and hypothesis tests. But as is often the case, explanations online either lacked the kind of formal treatment that makes me actually understand something, or the math was too specifically focussed on OLS regression in order for me to understand how it depends on the latter’s many assumptions. So here I want to briefly present this connection in a self-contained way.<sup id="fnref:nothing_new" role="doc-noteref"><a href="#fn:nothing_new" class="footnote" rel="footnote">1</a></sup></p><p>Let me first introduce some notation: We have a family of random variables \(X_\theta\) that all take values in some measurable space \(\mathcal{X}\) and whose probability distributions \(P_\theta\) are parametrized by elements \(\theta\) of another measurable space \(\Theta\). In the context of a regression we can think of every \(x \in \mathcal{X}\) as data that I sampled, \(X_\theta\) as the random variable describing the process of sampling, and \(\theta\) as the (unknown) value of the coefficients in a linear model. We abstractly describe an estimator as a function \(f: \mathcal{X} \to \Theta\) that maps any value of the random variable to some value \(\theta\) (think mapping a sample to an estimate of the coefficients).</p><p>A confidence interval then is a function that that maps values \(x\) into sets of parameter values such that, with sufficiently high probability contains \(\theta\), if \(x\) was sampled from \(P_\theta\). Lets formalize this. Given a confidence level \(\alpha \in [0,1]\), call a function \(g: \mathcal{X} \to \mathcal{P}(\Theta)\) an <em>\(\alpha\)-confidence interval map</em> if it has the property that, for any \(\theta \in \Theta\),</p>\[\mathrm{Prob}_{x \sim P_\theta}(\theta \in g(x)) \geq \alpha.\]<p>Here, \(\mathcal{P}(\Theta)\) denotes the power set (set of subsets) of \(\Theta\). The most fruitful way to think about confidence intervals (at least for me) is then that there is a <em>procedure</em> (represented by \(g\)) for generating confidence intervals from samples, such that, if I follow this procedure, then regardless of the value of \(\theta\), intervals generated according to this procedure will contain \(\theta\) with probability \(\alpha\).<sup id="fnref:confidence_interval" role="doc-noteref"><a href="#fn:confidence_interval" class="footnote" rel="footnote">2</a></sup></p><p>But now that we have understood what confidence intervals are about, the natural question is how to construct them. Here, we can use a simple but nice connection to hypothesis tests: For a hypothesis test, I use a data sample and an estimator to decide whether I can reject a null hypothesis about the true value of an unknown parameter with some significance threshold. More precisely, a hypothesis test should accept a false null hypothesis with a probability at most \(\alpha\). Let’s again formalise this idea: For a significance threshold \(\alpha \in [0,1]\), call a function \(h: \Theta \to \mathcal{P}(\Theta)\) an <em>\(\alpha\)-hypothesis test for estimator \(f\)</em> if, for any \(\theta\), \(\mathrm{Prob}_{x \sim P_\theta}(f(x) \in h(\theta)) \geq 1-\alpha\) and \(\theta \in h(\theta)\). The way we turn this into a hypothesis test is via the procedure “If \(f(x) \notin h(\theta)\), reject the null hypothesis that \(x\) was sampled from \(P_\theta\) with significance threshold \(\alpha\).”</p><p>Now, the nice thing is that we can construct an \(1- \alpha\)-confidence interval map from any estimator \(f\) and \(\alpha\)-hypothesis test for \(f, h\): Simply define</p>\[g(x) := \{\theta \in\Theta \quad \mathrm{ s.t. } \quad f(x) \in h(\theta)\}.\]<p>This maps any sample \(x\) to the set of parameter values \(\theta\) for which the estimator \(f(x)\) survives the hypothesis test defined by \(h\) and the null hypothesis \(\theta\). To see that this simple construction works note that, for any \(\theta\),</p><p>\(\mathrm{Prob}_{x \sim P_\theta}(\theta \in g(x)) = \mathrm{Prob}_{x \sim P_\theta}(f(x) \in h(\theta)) \geq 1- \alpha\),</p><p>where we used that \(\theta \in g(x) \Leftrightarrow f(x) \in h(\theta)\).</p><p>To make all of this less abstract, let me translate the above into the common case of a simple linear regression model: Every \(x\) is a data sample consisting of \(n\) pairs \((y_i, z_i)_{i=1}^n\)such that, for each pair we assume that it was generated according to the model \(Z_i = \beta Y_i + \beta_0 + \epsilon_i\), with additional assumptions about how the various errors terms are distributed, etc. If we want to use an \(x\) that we sample to generate a confidence interval (with confidence level \(95\%\)) for the coefficient \(\beta\), this means we are usually given the formula<sup id="fnref:change_alpha" role="doc-noteref"><a href="#fn:change_alpha" class="footnote" rel="footnote">3</a></sup></p>\[[\hat{\beta} - 1.96 \times SE(\hat{\beta}), \hat{\beta} + 1.96 \times SE(\hat{\beta})],\]<p>where \(\hat{\beta} \equiv \hat{\beta}(x)\) is the OLS estimator of \(\beta\) and \(SE(\hat{\beta})\) is its standard error. Using the above connection to hypothesis tests, we can identify this confidence interval map (since both OLS estimator is a function of the data, the above defines a map from data to sets of parameter values) as the one that is induced by an optimal<sup id="fnref:why_optimal" role="doc-noteref"><a href="#fn:why_optimal" class="footnote" rel="footnote">4</a></sup> \(5\%\)-hypothesis test for the normalised OLS estimator : That is, we set \(f(x) \equiv \hat{\beta}(x)/SE(\hat{\beta}(x))\)</p>\[h(\theta) = \arg \min_{[a,b] \subseteq \mathbb{R}: \mathrm{Prob}_{x \sim P_\theta}(\frac{\hat{\beta}}{SE(\hat{\beta})} \in [a,b] \geq 0.95)} b - a,\]<p>which is a somewhat convoluted way to write that we define \(h\) as mapping any value \(\theta\) to the smallest (in terms of the Lebesgue measure) interval such that, under the null hypothesis \(\theta\), the probability that the expression \(\hat{\beta}/SE(\hat{\beta})\) is contained in this interval is at least \(95\%\). Now, it conveniently turns out that under the usual assumptions of simple linear regression models, we know the distribution of this expression analytically to be a Student’s t-distribution, which is a bell-shaped distribution, centered around \(\theta\). Hence, $h$ defines a valid \(95\%\)-hypothesis test for \(\hat{\beta}\) and we can analytically evaluate its value (which is also called \(t\)-value) as</p><p>\(h(\theta) = [\theta - 1.96, \theta + 1.96]\).</p><p>Finally, in order to evaluate \(g\) based on \(h\), let’s think about the set of values \(\theta\) such that \(f(x) \in h(\theta)\). Since changing \(\theta\) simply shifts \(h(\theta)\) by a corresponding amount, we see that these are all the values within the interval \([f(x) - 1.96, f(x) + 1.96\)]. But since this is now a confidence interval for the normalized OLS estimator, in order to get an interval for \(\hat{\beta}\), we multiply this interval by the standard error, resulting in exactly the confidence interval we were given above.</p><hr /><div class="footnotes" role="doc-endnotes"><ol><li id="fn:nothing_new" role="doc-endnote"><p>None of this is original, even the Wikipedia article on confidence intervals touches everything I say, but it also just states connections and doesn’t show them. <a href="#fnref:nothing_new" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li><li id="fn:confidence_interval" role="doc-endnote"><p>An equivalent way of putting this is that the confidence interval is a random variable (namely, the one induced by \(P_\theta\) and \(g\)). <a href="#fnref:confidence_interval" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li><li id="fn:change_alpha" role="doc-endnote"><p>Changing the value of \(\alpha\) only changes the factor in front of the standard error <a href="#fnref:change_alpha" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li><li id="fn:why_optimal" role="doc-endnote"><p>A hypothesis test is called optimal if it always maps every hypothesis to the smallest set of candidates that are to survive the test, where size is measured by the measure on the space. <a href="#fnref:why_optimal" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li></ol></div></section><section><nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/2018/07/12/bitcoing-mining-as-a-sacrifice-ritual"><div class="nav-arrow">Previous</div><span class="post-title">Bitcoin mining as a sacrifice ritual</span> </a></nav></section></main><script> function setTheme(theme) { if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); } } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body></html>
